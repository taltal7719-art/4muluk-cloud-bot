from datetime import date
import math

# 20 –ø–µ—á–∞—Ç–µ–π Tzolk'in
TZOLKIN_NAMES = [
    "Imix", "Ik", "Akbal", "Kan", "Chicchan",
    "Cimi", "Manik", "Lamat", "Muluk", "Oc",
    "Chuen", "Eb", "Ben", "Ix", "Men",
    "Cib", "Caban", "Etznab", "Cauac", "Ahau"
]

# 18 –º–µ—Å—è—Ü–µ–≤ Haab + Wayeb
HAAB_NAMES = [
    "Pop", "Uo", "Zip", "Zotz", "Tzec",
    "Xul", "Yaxkin", "Mol", "Chen", "Yax",
    "Sac", "Ceh", "Mac", "Kankin", "Muan",
    "Pax", "Kayab", "Kumku", "Wayeb"
]

GMT_CORRELATION = 584283  # –Ω–∞—à–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è


def gregorian_to_jdn(year: int, month: int, day: int) -> int:
    """–ü–µ—Ä–µ–≤–æ–¥ –≥—Ä–∏–≥–æ—Ä–∏–∞–Ω—Å–∫–æ–π –¥–∞—Ç—ã –≤ —é–ª–∏–∞–Ω—Å–∫–∏–π –¥–µ–Ω—å (JDN)."""
    a = (14 - month) // 12
    y = year + 4800 - a
    m = month + 12 * a - 3
    jdn = day + ((153 * m + 2) // 5) + 365 * y + y // 4 - y // 100 + y // 400 - 32045
    return jdn


def mayan_from_gregorian(d: date):
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç Tzolk'in + Haab –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–π –¥–∞—Ç—ã –≤ —Å–∏—Å—Ç–µ–º–µ GMT 584283."""
    jdn = gregorian_to_jdn(d.year, d.month, d.day)
    days = jdn - GMT_CORRELATION  # –¥–Ω–∏ —Å 0.0.0.0.0

    # Tzolk'in: 0.0.0.0.0 = 4 Ahau
    tz_number = (days + 3) % 13 + 1          # –ø—Ä–∏ days=0 -> 4
    tz_index = (days + 19) % 20              # –ø—Ä–∏ days=0 -> Ahau (index 19)
    tz_name = TZOLKIN_NAMES[tz_index]

    # Haab: 0.0.0.0.0 = 8 Kumku
    haab_count = (days + 348) % 365          # 348-—è –ø–æ–∑–∏—Ü–∏—è = 8 Kumku
    haab_month_index = haab_count // 20
    haab_day = haab_count % 20
    haab_month_name = HAAB_NAMES[haab_month_index]

    return {
        "jdn": jdn,
        "days_from_start": days,
        "tz_number": tz_number,
        "tz_name": tz_name,
        "haab_day": haab_day,
        "haab_month_name": haab_month_name,
    }


# --- –õ–£–ù–ù–ê–Ø –§–ê–ó–ê --- #

def get_moon_phase(d: date) -> dict:
    """
    –ü—Ä–∏–º–µ—Ä–Ω–æ —Å—á–∏—Ç–∞–µ–º —Ñ–∞–∑—É –õ—É–Ω—ã:
    –æ–ø–æ—Ä–Ω–æ–µ –Ω–æ–≤–æ–ª—É–Ω–∏–µ 2000-01-06 (JDN ~ 2451550.1),
    —Å–∏–Ω–æ–¥–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–∏–æ–¥ 29.53058867 —Å—É—Ç–æ–∫.
    –ù–∞–º –Ω—É–∂–Ω–∞ –Ω–µ –∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –∞ —Ç–æ—Ä–≥–æ–≤–æ-—ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è.
    """
    jdn = gregorian_to_jdn(d.year, d.month, d.day)
    known_new_moon = 2451550.1
    synodic_month = 29.53058867

    days_since = jdn - known_new_moon
    age = days_since % synodic_month  # –≤–æ–∑—Ä–∞—Å—Ç –õ—É–Ω—ã –≤ —Å—É—Ç–∫–∞—Ö
    illum = (1 - math.cos(2 * math.pi * age / synodic_month)) / 2

    half = synodic_month / 2
    if age < 1.0 or age > synodic_month - 1.0:
        code = "new"
        name = "–ù–æ–≤–æ–ª—É–Ω–∏–µ"
        emoji = "üåë"
    elif abs(age - half) < 1.5:
        code = "full"
        name = "–ü–æ–ª–Ω–æ–ª—É–Ω–∏–µ"
        emoji = "üåï"
    elif age < half:
        code = "waxing"
        name = "–†–∞—Å—Ç—É—â–∞—è –õ—É–Ω–∞"
        emoji = "üåì"
    else:
        code = "waning"
        name = "–£–±—ã–≤–∞—é—â–∞—è –õ—É–Ω–∞"
        emoji = "üåó"

    return {
        "age": age,          # –≤–æ–∑—Ä–∞—Å—Ç –≤ —Å—É—Ç–∫–∞—Ö
        "illum": illum,      # –æ—Å–≤–µ—â—ë–Ω–Ω–æ—Å—Ç—å (0..1)
        "phase_code": code,  # new / waxing / full / waning
        "phase_name": name,
        "phase_emoji": emoji,
    }


# --- –ü–†–û–§–ò–õ–ò –ü–ï–ß–ê–¢–ï–ô --- #

SIGN_PROFILES = {
    "Imix": {
        "ru": "–ò–º–∏–∫—Å ‚Äî –ü–µ—Ä–≤–æ–∏—Å—Ç–æ—á–Ω–∏–∫, —Ö–∞–æ—Ç–∏—á–Ω–∞—è –≤–æ–¥–∞",
        "arch": "–≠–Ω–µ—Ä–≥–∏—è –Ω–∞—á–∞–ª–∞, —Ö–∞–æ—Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞, —Å—ã—Ä–∞—è —Å–∏–ª–∞. –î–µ–Ω—å –∏–Ω—Å—Ç–∏–Ω–∫—Ç–æ–≤ –∏ –±–∞–∑–æ–≤—ã—Ö –∏–º–ø—É–ª—å—Å–æ–≤.",
        "crowd": "–¢–æ–ª–ø–∞ –¥–µ–π—Å—Ç–≤—É–µ—Ç –∏–º–ø—É–ª—å—Å–∏–≤–Ω–æ –∏ –Ω–µ—Ä–æ–≤–Ω–æ, –º–Ω–æ–≥–æ —Å—ã—Ä–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è –±–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.",
        "trading": "–†—ã–Ω–æ–∫ –º–æ–∂–µ—Ç –≤–µ—Å—Ç–∏ —Å–µ–±—è —Ä–≤–∞–Ω–æ, –ª—É—á—à–µ –º–∞–ª–µ–Ω—å–∫–∏–µ –æ–±—ä—ë–º—ã –∏–ª–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ."
    },
    "Ik": {
        "ru": "–ò–∫ ‚Äî –í–µ—Ç–µ—Ä, —Å–ª–æ–≤–æ, –∏–¥–µ–∏",
        "arch": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –Ω–æ–≤–æ—Å—Ç–∏, –æ–±—â–µ–Ω–∏–µ, –¥–≤–∏–∂–µ–Ω–∏–µ –º—ã—Å–ª–∏.",
        "crowd": "–¢–æ–ª–ø–∞ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –Ω–æ–≤–æ—Å—Ç–∏ –∏ —Å–ª—É—Ö–∏, —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è –≤–ª–∏—è–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.",
        "trading": "–•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ–≤–æ—Å—Ç–∏, —Ä–µ–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è, –≤–∞–∂–Ω–æ –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —Å–µ–±—è —à—É–º–æ–º."
    },
    "Akbal": {
        "ru": "–ê–∫–±–∞–ª—å ‚Äî –ù–æ—á—å, –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ",
        "arch": "–ì–ª—É–±–∏–Ω–∞, —Å–Ω—ã, —Å–∫—Ä—ã—Ç—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, —Å—Ç—Ä–∞—Ö–∏ –∏ –∏–Ω—Ç—É–∏—Ü–∏—è.",
        "crowd": "–¢–æ–ª–ø–∞ –¥–µ–π—Å—Ç–≤—É–µ—Ç –∏–∑ —Å—Ç—Ä–∞—Ö–æ–≤ –∏ –æ–∂–∏–¥–∞–Ω–∏–π, –º–Ω–æ–≥–æ —Å–∫—Ä—ã—Ç—ã—Ö –º–æ—Ç–∏–≤–æ–≤.",
        "trading": "–û—Å—Ç–æ—Ä–æ–∂–Ω–æ —Å —ç–º–æ—Ü–∏—è–º–∏, –ª—É—á—à–µ –Ω–∞–±–ª—é–¥–∞—Ç—å —É—Ä–æ–≤–Ω–∏ –∏ –Ω–µ —Ñ–æ—Ä—Å–∏—Ç—å –≤—Ö–æ–¥—ã."
    },
    "Kan": {
        "ru": "–ö–∞–Ω ‚Äî –°–µ–º—è, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–æ—Å—Ç–∞",
        "arch": "–†–æ—Å—Ç, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª, –ø–æ—Å–µ–≤, –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã.",
        "crowd": "–¢–æ–ª–ø–∞ –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏, —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –∑–∞—Ä–æ–¥—ã—à–∏ —Ç—Ä–µ–Ω–¥–æ–≤.",
        "trading": "–ú–æ–∂–Ω–æ –≤—Ö–æ–¥–∏—Ç—å –≤ –∑–∞—Ä–æ–∂–¥–∞—é—â–∏–µ—Å—è –¥–≤–∏–∂–µ–Ω–∏—è, –≤–∞–∂–Ω–∞ —Ç–µ—Ä–ø–µ–ª–∏–≤–æ—Å—Ç—å."
    },
    "Chicchan": {
        "ru": "–ß–∏–∫—á–∞–Ω ‚Äî –ó–º–µ—è, –æ–≥–Ω–µ–Ω–Ω–∞—è —Å–∏–ª–∞",
        "arch": "–ò–Ω—Å—Ç–∏–Ω–∫—Ç, —Å—Ç—Ä–∞—Å—Ç—å, –≤—ã–∂–∏–≤–∞–Ω–∏–µ, —Å–∏–ª—å–Ω–∞—è —Ç–µ–ª–µ—Å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è.",
        "crowd": "–¢–æ–ª–ø–∞ –¥–µ–π—Å—Ç–≤—É–µ—Ç —Ä–µ–∑–∫–æ, –Ω–∞ –∏–Ω—Å—Ç–∏–Ω–∫—Ç–∞—Ö, –≤—Å–ø–ª–µ—Å–∫–∏ –∏ –≤—ã–Ω–æ—Å—ã.",
        "trading": "–û–ø–∞—Å–Ω—ã–π –¥–µ–Ω—å –¥–ª—è 4 Muluk, –≤—ã—Å–æ–∫–∏–µ —Ä–∏—Å–∫–∏ –∏–º–ø—É–ª—å—Å–∏–≤–Ω—ã—Ö –¥–≤–∏–∂–µ–Ω–∏–π."
    },
    "Cimi": {
        "ru": "–ö–∏–º–∏ ‚Äî –°–º–µ—Ä—Ç—å, –ø–µ—Ä–µ—Ö–æ–¥",
        "arch": "–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ, —Å–º–µ–Ω–∞ —Ñ–∞–∑.",
        "crowd": "–¢–æ–ª–ø–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏, –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ü–∏–∫–ª—ã, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–±–Ω—É–ª–µ–Ω–∏–µ.",
        "trading": "–ú–æ–∂–µ—Ç –±—ã—Ç—å —Å–∏–ª—å–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, –ª—É—á—à–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å, —á–µ–º –æ—Ç–∫—Ä—ã–≤–∞—Ç—å."
    },
    "Manik": {
        "ru": "–ú–∞–Ω–∏–∫ ‚Äî –†—É–∫–∞, —Ü–µ–ª–∏—Ç–µ–ª—å",
        "arch": "–ü–æ–º–æ—â—å, –∏—Å—Ü–µ–ª–µ–Ω–∏–µ, –ø–æ–¥–¥–µ—Ä–∂–∫–∞, –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ.",
        "crowd": "–¢–æ–ª–ø–∞ –∏—â–µ—Ç —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏, –ø–æ–¥–¥–µ—Ä–∂–∫–∏, –æ–ø–æ—Ä—ã.",
        "trading": "–ù–µ–ø–ª–æ—Ö–∏–µ –¥–Ω–∏ –¥–ª—è –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π."
    },
    "Lamat": {
        "ru": "–õ–∞–º–∞—Ç ‚Äî –ó–≤–µ–∑–¥–∞, –í–µ–Ω–µ—Ä–∞",
        "arch": "–ö—Ä–∞—Å–æ—Ç–∞, –ø–ª–æ–¥–æ—Ä–æ–¥–∏–µ, —É—Å–∏–ª–µ–Ω–∏–µ, —Å–∏—è–Ω–∏–µ.",
        "crowd": "–¢–æ–ª–ø–∞ –ª–µ–≥–∫–æ —É—Å–∏–ª–∏–≤–∞–µ—Ç –ª—é–±—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è ‚Äì –∏ —Å—Ç—Ä–∞—Ö, –∏ —ç–π—Ñ–æ—Ä–∏—é.",
        "trading": "–°–∏–ª—å–Ω—ã–π —Å–æ—é–∑–Ω—ã–π –¥–µ–Ω—å –¥–ª—è 4 Muluk, –Ω–æ –≤–∞–∂–Ω–æ –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å –æ–±—ä—ë–º—ã."
    },
    "Muluk": {
        "ru": "–ú—É–ª—É–∫ ‚Äî –í–æ–¥–∞, –ø–æ–¥–Ω–æ—à–µ–Ω–∏–µ",
        "arch": "–≠–º–æ—Ü–∏–∏, –æ—á–∏—â–µ–Ω–∏–µ, –ø–∞–º—è—Ç—å, –≥–ª—É–±–∏–Ω–∞ —á—É–≤—Å—Ç–≤.",
        "crowd": "–¢–æ–ª–ø–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞, —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –º–∞–ª–µ–π—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.",
        "trading": "–¢–≤–æ–π —Ä–æ–¥–Ω–æ–π –∞—Ä—Ö–µ—Ç–∏–ø. –ü—Ä–∏ —Ö–æ—Ä–æ—à–µ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ñ–æ—Ä–º–µ ‚Äî –æ—á–µ–Ω—å —Ç–æ—á–Ω–∞—è –∏–Ω—Ç—É–∏—Ü–∏—è."
    },
    "Oc": {
        "ru": "–û–∫ ‚Äî –°–æ–±–∞–∫–∞, –≤–µ—Ä–Ω–æ—Å—Ç—å",
        "arch": "–ü—Ä–µ–¥–∞–Ω–Ω–æ—Å—Ç—å, –ø–æ–¥–¥–µ—Ä–∂–∫–∞, –¥–æ–≤–µ—Ä–∏–µ, –¥—Ä—É–∂–±–∞.",
        "crowd": "–¢–æ–ª–ø–∞ –¥–µ–π—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–¥–Ω–æ, –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ª–∏–¥–µ—Ä–æ–≤ –∏ —Å–∏–≥–Ω–∞–ª—ã –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–æ–≤.",
        "trading": "–°–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞–º –∏ —á—É–∂–∏–º –º–Ω–µ–Ω–∏—è–º –æ–±–æ—Å—Ç—Ä–µ–Ω–æ, –≤–∞–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å —Å–≤–æ—é —Å–∏—Å—Ç–µ–º—É."
    },
    "Chuen": {
        "ru": "–ß—É—ç–Ω ‚Äî –û–±–µ–∑—å—è–Ω–∞, –∏–≥—Ä–æ–∫",
        "arch": "–ò–≥—Ä–∞, —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ, –∞—Ä—Ç–∏—Å—Ç–∏–∑–º, –∏–º–ø—Ä–æ–≤–∏–∑–∞—Ü–∏—è.",
        "crowd": "–¢–æ–ª–ø–∞ —Å–∫–ª–æ–Ω–Ω–∞ –∫ —Å–ø–µ–∫—É–ª—è—Ü–∏—è–º –∏ –∏–≥—Ä–µ, –±–æ–ª—å—à–µ —à—É–º–∞.",
        "trading": "–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–ª–∫–∏–µ –±—ã—Å—Ç—Ä—ã–µ —Å–¥–µ–ª–∫–∏, –Ω–æ –≤–∞–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—É."
    },
    "Eb": {
        "ru": "–≠–± ‚Äî –î–æ—Ä–æ–≥–∞, –ø—É—Ç—å",
        "arch": "–í—ã–±–æ—Ä –ø—É—Ç–∏, –¥–≤–∏–∂–µ–Ω–∏–µ –∂–∏–∑–Ω–∏, —ç–≤–æ–ª—é—Ü–∏—è.",
        "crowd": "–¢–æ–ª–ø–∞ –∏—â–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –º–Ω–æ–≥–æ —Å–º–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π.",
        "trading": "–•–æ—Ä–æ—à–æ –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏, –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å."
    },
    "Ben": {
        "ru": "–ë–µ–Ω ‚Äî –¢—Ä–æ—Å—Ç–Ω–∏–∫, –∫–æ–ª–æ–Ω–Ω–∞",
        "arch": "–í–µ—Ä—Ç–∏–∫–∞–ª—å, –ø—Ä–∏–Ω—Ü–∏–ø—ã, –ø—É—Ç—å –≤ –≤—ã—Å–æ—Ç—É.",
        "crowd": "–¢–æ–ª–ø–∞ –∏—â–µ—Ç –æ–ø–æ—Ä—É –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –ª–∏–¥–µ—Ä—Å—Ç–≤—É.",
        "trading": "–û–∫–∫—É–ª—å—Ç–Ω—ã–π —Å–æ—é–∑–Ω–∏–∫ 4 Muluk. –•–æ—Ä–æ—à–∏–µ –¥–Ω–∏ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π."
    },
    "Ix": {
        "ru": "–ò—à ‚Äî –Ø–≥—É–∞—Ä, –º–∞–≥–∏—è",
        "arch": "–ú–∞–≥–∏—è, —Å–∫—Ä—ã—Ç–∞—è —Å–∏–ª–∞, —Å–≤—è–∑—å —Å —Ç–æ–Ω–∫–∏–º –º–∏—Ä–æ–º.",
        "crowd": "–ú–Ω–æ–≥–æ –∏—Ä—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ, —Ç–æ–ª–ø–∞ –º–æ–∂–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–Ω–æ.",
        "trading": "–°—Ç–æ–∏—Ç –æ–ø–∏—Ä–∞—Ç—å—Å—è –Ω–∞ –≥–ª—É–±–æ–∫—É—é –∏–Ω—Ç—É–∏—Ü–∏—é, –Ω–æ –Ω–µ –∑–∞–±—ã–≤–∞—Ç—å —Ä–∞–º–∫–∏ —Å–∏—Å—Ç–µ–º—ã."
    },
    "Men": {
        "ru": "–ú–µ–Ω ‚Äî –û—Ä—ë–ª, –æ–±–∑–æ—Ä",
        "arch": "–í–∏–¥ —Å–≤–µ—Ä—Ö—É, —Å—Ç—Ä–∞—Ç–µ–≥–∏—è, –¥–∞–ª—å–Ω–µ–µ –≤–∏–¥–µ–Ω–∏–µ.",
        "crowd": "–¢–æ–ª–ø–∞ —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ –±–æ–ª—å—à–∏–µ –∫–∞—Ä—Ç–∏–Ω—ã, —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏.",
        "trading": "–•–æ—Ä–æ—à–æ –¥–ª—è —Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏—Ö —Ä–µ—à–µ–Ω–∏–π."
    },
    "Cib": {
        "ru": "–ö–∏–± ‚Äî –ú—É–¥—Ä–µ—Ü, –¥–∞–≤–ª–µ–Ω–∏–µ —É–º–∞",
        "arch": "–ö–∞—Ä–º–∞, –¥–æ–ª–≥–∏, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ.",
        "crowd": "–¢–æ–ª–ø–∞ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–∞ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è–º–∏ –∏ —Å—Ç—Ä–∞—Ö–∞–º–∏ –æ—à–∏–±–∏—Ç—å—Å—è.",
        "trading": "–û–ø–∞—Å–Ω—ã–π –¥–µ–Ω—å ‚Äî –º–æ–∂–Ω–æ –∑–∞—É–º—Å—Ç–≤–æ–≤–∞—Ç—å –∏ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –æ—á–µ–≤–∏–¥–Ω–æ–µ."
    },
    "Caban": {
        "ru": "–ö–∞–±–∞–Ω ‚Äî –ó–µ–º–ª—è, –¥–≤–∏–∂–µ–Ω–∏–µ –ø–ª–∞—Å—Ç–∞",
        "arch": "–ì–ª—É–±–æ–∫–∏–µ —Å–¥–≤–∏–≥–∏, —Ç–µ–∫—Ç–æ–Ω–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π, —É—Å—Ç–æ–π—á–∏–≤—ã–µ —Ç—Ä–µ–Ω–¥—ã.",
        "crowd": "–¢–æ–ª–ø–∞ –º–µ–¥–ª–µ–Ω–Ω–æ, –Ω–æ –≤–µ—Ä–Ω–æ –º–µ–Ω—è–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.",
        "trading": "–û—Ç–ª–∏—á–Ω–æ –¥–ª—è —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–Ω–¥—É –∏ —Ä–∞–±–æ—Ç—ã —Å —É—Ä–æ–≤–Ω—è–º–∏."
    },
    "Etznab": {
        "ru": "–≠—Ü–Ω–∞–± ‚Äî –ö—Ä–µ–º–µ–Ω—å, –∑–µ—Ä–∫–∞–ª–æ",
        "arch": "–†–µ–∑–∫–∏–µ —Å—Ä–µ–∑—ã, –ø—Ä–∞–≤–¥–∞, –∑–µ—Ä–∫–∞–ª–∞, —Ä–∞–∑—Ä–µ–∑–∞–Ω–∏–µ –∏–ª–ª—é–∑–∏–π.",
        "crowd": "–ú–æ–≥—É—Ç –±—ã—Ç—å —Ä–µ–∑–∫–∏–µ —Å–º–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π –∏ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã.",
        "trading": "–û—Å—Ç–æ—Ä–æ–∂–Ω–æ —Å —Ä–µ–∑–∫–∏–º–∏ –¥–≤–∏–∂–µ–Ω–∏—è–º–∏, –¥–µ–Ω—å –¥–ª—è —á–µ—Å—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞."
    },
    "Cauac": {
        "ru": "–ö–∞—É–∞–∫ ‚Äî –ë—É—Ä—è, –æ—á–∏—â–∞—é—â–∏–π —à—Ç–æ—Ä–º",
        "arch": "–°–∏–ª—å–Ω—ã–µ –∫—Ä–∏–∑–∏—Å—ã, –±—É—Ä–Ω–∞—è —Ä–∞–∑—Ä—è–¥–∫–∞.",
        "crowd": "–¢–æ–ª–ø–∞ –≤ –ø–∞–Ω–∏–∫–µ –∏–ª–∏ —ç–π—Ñ–æ—Ä–∏–∏, —Å–∏–ª—å–Ω—ã–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤—ã–±—Ä–æ—Å—ã.",
        "trading": "–û—á–µ–Ω—å –æ–ø–∞—Å–Ω—ã–π –¥–µ–Ω—å, –ª–æ–≤—É—à–∫–∏, –ª–æ–∂–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è, –≤—ã—Å–æ–∫–∏–µ —Ä–∏—Å–∫–∏."
    },
    "Ahau": {
        "ru": "–ê—Ö–∞—É ‚Äî –°–æ–ª–Ω—Ü–µ, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ",
        "arch": "–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å, —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —Å–≤–µ—Ç, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è.",
        "crowd": "–¢–æ–ª–ø–∞ –≤–∏–¥–∏—Ç –∏—Ç–æ–≥, –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç, –ø–æ–¥–≤–æ–¥–∏—Ç —á–µ—Ä—Ç—É.",
        "trading": "–•–æ—Ä–æ—à–æ –∑–∞–≤–µ—Ä—à–∞—Ç—å —Ü–∏–∫–ª—ã, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∞ –Ω–µ –Ω–∞—á–∏–Ω–∞—Ç—å –Ω–æ–≤–æ–µ."
    },
}

# --- –ü–†–û–§–ò–õ–ò –¢–û–ù–û–í --- #

TONE_PROFILES = {
    1: {
        "name": "1 ‚Äî –ò—Å—Ç–æ–∫",
        "essence": "–¢–æ–Ω –Ω–∞—á–∞–ª–∞, –ø–æ—è–≤–ª–µ–Ω–∏—è –∏–º–ø—É–ª—å—Å–∞. –ú–Ω–æ–≥–æ —Å—ã—Ä–æ–π —ç–Ω–µ—Ä–≥–∏–∏, –Ω–æ –º–∞–ª–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.",
        "trading": "–•–æ—Ä–æ—à–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∏ –Ω–∞–∫–∏–¥—ã–≤–∞—Ç—å –∏–¥–µ–∏, –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∞–∫—Ç–∏–≤–Ω–æ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å."
    },
    2: {
        "name": "2 ‚Äî –î—É–∞–ª—å–Ω–æ—Å—Ç—å",
        "essence": "–ö–æ–Ω—Ñ–ª–∏–∫—Ç, –≤—ã–±–æ—Ä, –∫–∞—á–µ–ª–∏ –º–µ–∂–¥—É –¥–∞ –∏ –Ω–µ—Ç.",
        "trading": "–û–ø–∞—Å–Ω—ã–π —Ç–æ–Ω: —Å–æ–º–Ω–µ–Ω–∏—è, –º–µ—Ç–∞–Ω–∏—è. –õ—É—á—à–µ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –≤–∞–∂–Ω—ã–µ —Å–¥–µ–ª–∫–∏."
    },
    3: {
        "name": "3 ‚Äî –î–≤–∏–∂–µ–Ω–∏–µ",
        "essence": "–ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞, –ø–µ—Ä–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, —Ä–∏—Ç–º.",
        "trading": "–ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –Ω–µ–±–æ–ª—å—à–∏–µ —Å–¥–µ–ª–∫–∏ –ø–æ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏, –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—è—Å—å."
    },
    4: {
        "name": "4 ‚Äî –°—Ç—Ä—É–∫—Ç—É—Ä–∞",
        "essence": "–¢–≤–æ–π —Ä–æ–¥–Ω–æ–π —Ç–æ–Ω. –§–æ—Ä–º–∞, –ø–æ—Ä—è–¥–æ–∫, —Ä–∞–º–∫–∏, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å.",
        "trading": "–°–∞–º—ã–µ —Å–∏–ª—å–Ω—ã–µ –¥–Ω–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ —á—ë—Ç–∫–∏—Ö —Ä–µ—à–µ–Ω–∏–π."
    },
    5: {
        "name": "5 ‚Äî –°–∏–ª–∞",
        "essence": "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ü–µ–Ω—Ç—Ä, –æ–ø–æ—Ä–∞.",
        "trading": "–•–æ—Ä–æ—à–∏–µ –¥–Ω–∏ –¥–ª—è —É–≤–µ—Ä–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –ø–æ–Ω—è—Ç–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏."
    },
    6: {
        "name": "6 ‚Äî –ü–æ—Ç–æ–∫",
        "essence": "–†–∏—Ç–º, —É—Å—Ç–æ—è–≤—à–µ–µ—Å—è –¥–≤–∏–∂–µ–Ω–∏–µ, –ø–ª–∞–≤–Ω–æ—Å—Ç—å.",
        "trading": "–•–æ—Ä–æ—à–æ —Å–ª–µ–¥–æ–≤–∞—Ç—å —Ç—Ä–µ–Ω–¥–∞–º, –±–µ–∑ —Ä–µ–∑–∫–∏—Ö —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤ –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤."
    },
    7: {
        "name": "7 ‚Äî –†–µ–∑–æ–Ω–∞–Ω—Å",
        "essence": "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª, —Ç–æ–Ω–∫–æ–µ —á—É–≤—Å—Ç–≤–æ–≤–∞–Ω–∏–µ.",
        "trading": "–°–∏–ª—å–Ω—ã–µ –¥–Ω–∏ –¥–ª—è –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞."
    },
    8: {
        "name": "8 ‚Äî –ì–∞—Ä–º–æ–Ω–∏—è",
        "essence": "–ë–∞–ª–∞–Ω—Å, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ, —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å.",
        "trading": "–ü–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è —Å–ø–æ–∫–æ–π–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ –≤—ã–≤–µ—Ä–µ–Ω–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤."
    },
    9: {
        "name": "9 ‚Äî –ü–∏–∫",
        "essence": "–£—Å–∏–ª–µ–Ω–∏–µ –≤—Å–µ–≥–æ, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–∞–∫—Å–∏–º—É–º.",
        "trading": "–û–ø–∞—Å–Ω—ã–π —Ç–æ–Ω ‚Äî –≤—Å—ë —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è, –≤ —Ç–æ–º —á–∏—Å–ª–µ –æ—à–∏–±–∫–∏ –∏ –∏–º–ø—É–ª—å—Å—ã."
    },
    10: {
        "name": "10 ‚Äî –ü—Ä–æ—è–≤–ª–µ–Ω–∏–µ",
        "essence": "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã, –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ —Å—Ç—Ä–æ–∏–ª–æ—Å—å.",
        "trading": "–•–æ—Ä–æ—à–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å, –≤–∏–¥–µ—Ç—å –∏—Ç–æ–≥–∏, –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å –Ω–æ–≤–æ–µ."
    },
    11: {
        "name": "11 ‚Äî –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ",
        "essence": "–°–±—Ä–æ—Å –ª–∏—à–Ω–µ–≥–æ, –æ—Ç—Å–µ—á–µ–Ω–∏–µ, —Ä–∞–∑—Ä—è–¥–∫–∞.",
        "trading": "–û–ø–∞—Å–Ω—ã–π –¥–ª—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π, –Ω–æ –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è —á–∏—Å—Ç–∫–∏ —Å–∏—Å—Ç–µ–º—ã –∏ –ø—Ä–∏–≤—ã—á–µ–∫."
    },
    12: {
        "name": "12 ‚Äî –°–∏–Ω—Ç–µ–∑",
        "essence": "–ü–æ–Ω–∏–º–∞–Ω–∏–µ, –º—É–¥—Ä–æ—Å—Ç—å, –æ–±–æ–±—â–µ–Ω–∏–µ –æ–ø—ã—Ç–∞.",
        "trading": "–û—Ç–ª–∏—á–Ω—ã–µ –¥–Ω–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π."
    },
    13: {
        "name": "13 ‚Äî –°–∫–∞—á–æ–∫",
        "essence": "–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ü–∏–∫–ª–∞.",
        "trading": "–ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å, –Ω–æ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å –±–æ–ª—å—à–∏–µ –∏–Ω—Å–∞–π—Ç—ã –æ —Ä—ã–Ω–∫–µ –∏ —Å–µ–±–µ."
    },
}


def _trading_signal_from_level(level: str) -> tuple[str, str]:
    """
    –ü–µ—Ä–µ–≤–æ–¥ —É—Ä–æ–≤–Ω—è –¥–Ω—è –≤ —Å–∏–≥–Ω–∞–ª –¥–ª—è 4 Muluk:
    –†–ê–ó–†–ï–®–ï–ù–û / –û–°–¢–û–†–û–ñ–ù–û / –°–¢–û–ü.
    """
    if level == "strong":
        return (
            "–†–ê–ó–†–ï–®–ï–ù–û",
            "–î–µ–Ω—å —Å–∏–ª—ã –¥–ª—è 4 Muluk: –º–æ–∂–Ω–æ –∞–∫—Ç–∏–≤–Ω–æ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å –ø–æ —Å–∏—Å—Ç–µ–º–µ, –Ω–æ –±–µ–∑ –Ω–∞—Ä—É—à–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª —Ä–∏—Å–∫–∞."
        )
    if level == "normal":
        return (
            "–†–ê–ó–†–ï–®–ï–ù–û (–ê–ö–ö–£–†–ê–¢–ù–û)",
            "–î–µ–Ω—å –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –ø–æ —Å–∏—Å—Ç–µ–º–µ —Å –æ–±—ã—á–Ω—ã–º–∏ –æ–±—ä—ë–º–∞–º–∏ –∏ –≤–Ω–∏–º–∞–Ω–∏–µ–º –∫ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ."
        )
    if level == "background":
        return (
            "–û–°–¢–û–†–û–ñ–ù–û",
            "–õ—É—á—à–µ —É–º–µ–Ω—å—à–∏—Ç—å –æ–±—ä—ë–º, —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–≤—è—Ç–∏—Ç—å –Ω–∞–±–ª—é–¥–µ–Ω–∏—é –∏ –¥–æ—Ä–∞–±–æ—Ç–∫–µ —Å–∏—Å—Ç–µ–º—ã, –∞ –Ω–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ."
        )
    # danger
    return (
        "–°–¢–û–ü",
        "–î–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω–Ω–æ–≥–æ —Ä–∏—Å–∫–∞ –¥–ª—è 4 Muluk: –ª—É—á—à–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–æ–∑–¥–µ—Ä–∂–∞—Ç—å—Å—è –æ—Ç —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ –≤–∞–∂–Ω—ã—Ö –∏–º–ø—É–ª—å—Å–∏–≤–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π."
    )


def classify_day(tz_number: int, tz_name: str, moon_phase_code: str | None = None) -> dict:
    """
    –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–Ω—è –¥–ª—è 4 Muluk:
    strong / normal / background / danger
    + —É—á–∏—Ç—ã–≤–∞–µ–º –ª—É–Ω–Ω—É—é —Ñ–∞–∑—É (–æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–Ω–æ–ª—É–Ω–∏–µ –∏ —É–±—ã–≤–∞—é—â—É—é –õ—É–Ω—É).
    """
    strong_signs = {"Muluk", "Lamat", "Ben"}
    danger_signs = {"Chicchan", "Cimi", "Cauac", "Cib"}
    strong_tones = {4, 5, 6, 7}
    danger_tones = {2, 9, 11}

    score = 0

    if tz_name in strong_signs:
        score += 2
    if tz_name in danger_signs:
        score -= 2
    if tz_number in strong_tones:
        score += 1
    if tz_number in danger_tones:
        score -= 1

    # –õ—É–Ω–∞: —É–±—ã–≤–∞—é—â–∞—è ‚Üí –æ—á–∏—â–∞–µ—Ç –≤–æ–¥—É (—á—É—Ç—å –ø–ª—é—Å),
    # –ø–æ–ª–Ω–æ–ª—É–Ω–∏–µ ‚Üí —Ä–∞–∑–¥—É–≤–∞–µ—Ç —ç–º–æ—Ü–∏–∏ (–º–∏–Ω—É—Å).
    if moon_phase_code == "waning":
        score += 1
    elif moon_phase_code == "full":
        score -= 1

    if score >= 2:
        level = "strong"
        label = "–°–∏–ª—å–Ω—ã–π –¥–µ–Ω—å"
        desc = "–†–µ–∑–æ–Ω–∞–Ω—Å —Å —Ç–≤–æ–∏–º 4 Muluk. –î–µ–Ω—å –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏, –≤–∞–∂–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π."
    elif score >= 0:
        level = "normal"
        label = "–ù–æ—Ä–º–∞–ª—å–Ω—ã–π –¥–µ–Ω—å"
        desc = "–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–µ–Ω—å. –ú–æ–∂–Ω–æ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å –ø–æ —Å–∏—Å—Ç–µ–º–µ –∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–∞–±–æ—á–∏–µ —Ä–µ—à–µ–Ω–∏—è."
    elif score >= -1:
        level = "background"
        label = "–§–æ–Ω–æ–≤—ã–π –¥–µ–Ω—å"
        desc = "–≠–Ω–µ—Ä–≥–∏—è –Ω–µ –≤ –ø–∏–∫–µ. –õ—É—á—à–µ –Ω–∞–±–ª—é–¥–∞—Ç—å, –≥–æ—Ç–æ–≤–∏—Ç—å—Å—è, –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É, —á–µ–º —Ä–∏—Å–∫–æ–≤–∞—Ç—å."
    else:
        level = "danger"
        label = "–û–ø–∞—Å–Ω—ã–π –¥–µ–Ω—å"
        desc = "–ü–æ–≤—ã—à–µ–Ω–Ω—ã–π —Ö–∞–æ—Å –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ª–æ–≤—É—à–∫–∏. –õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ ‚Äî –Ω–µ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å –∏ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–∞–¥–∏–∫–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è."

    signal_label, signal_desc = _trading_signal_from_level(level)

    return {
        "level": level,
        "label": label,
        "description": desc,
        "trading_signal_label": signal_label,
        "trading_signal_description": signal_desc,
    }


def get_crowd_state(tz_number: int, tz_name: str, moon_phase_code: str | None = None) -> dict:
    """
    –ö–æ—Ä–æ—Ç–∫–∏–π —Ü–∏—Ñ—Ä–æ–≤–æ–π —Å—Ç–∞—Ç—É—Å —Ç–æ–ª–ø—ã –¥–ª—è –±–æ—Ç–∞:
    code: panic / volatile / calm / trend
    + —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π label –∏ description.
    """
    # –ë–∞–∑–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ –ø–µ—á–∞—Ç–∏
    if tz_name in {"Cauac", "Chicchan"}:
        base = "panic"
    elif tz_name in {"Cimi", "Etznab", "Cib"}:
        base = "volatile"
    elif tz_name in {"Muluk", "Lamat", "Imix", "Akbal", "Oc", "Chuen", "Eb", "Ix", "Men"}:
        base = "volatile"
    elif tz_name in {"Caban", "Ben", "Manik", "Kan", "Ahau"}:
        base = "trend"
    else:
        base = "calm"

    # –ö–æ—Ä—Ä–µ–∫—Ü–∏—è —Ç–æ–Ω–æ–º
    if tz_number in {2, 9, 11}:  # —Å—Ç—Ä–µ—Å—Å–æ–≤—ã–µ
        if base == "calm":
            base = "volatile"
        elif base == "volatile":
            base = "panic"
    elif tz_number in {4, 5, 6, 7, 8, 12}:  # —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ/–≥–∞—Ä–º–æ–Ω–∏—á–Ω—ã–µ
        if base == "panic":
            base = "volatile"
        elif base == "volatile":
            base = "trend"
        elif base == "calm":
            base = "trend"

    # –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –õ—É–Ω–æ–π
    if moon_phase_code == "full":
        if base == "calm":
            base = "volatile"
        elif base == "volatile":
            base = "panic"
    elif moon_phase_code == "waning":
        if base == "panic":
            base = "volatile"
        elif base == "volatile":
            base = "calm"

    # –°–ª–æ–≤–µ—Å–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è
    labels = {
        "panic": "–ü–∞–Ω–∏–∫–∞",
        "volatile": "–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å",
        "calm": "–°–ø–æ–∫–æ–π–Ω—ã–π —Ä—ã–Ω–æ–∫",
        "trend": "–¢—Ä–µ–Ω–¥–æ–≤—ã–π —Ä—ã–Ω–æ–∫",
    }
    descriptions = {
        "panic": "–¢–æ–ª–ø–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–∞–Ω–∏–∫–∏ –∏–ª–∏ —ç–π—Ñ–æ—Ä–∏–∏, –¥–≤–∏–∂–µ–Ω–∏—è —Ä–µ–∑–∫–∏–µ –∏ —á–∞—Å—Ç–æ –Ω–µ–ª–æ–≥–∏—á–Ω—ã–µ. –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –ª–æ–≤—É—à–µ–∫ –∏ –≤—ã–Ω–æ—Å–æ–≤.",
        "volatile": "–†—ã–Ω–æ–∫ –Ω–µ—Ä–≤–Ω—ã–π, –¥–≤–∏–∂–µ–Ω–∏—è –∞–º–ø–ª–∏—Ç—É–¥–Ω—ã–µ, –Ω–æ –µ—â—ë –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ö–∞–æ—Ç–∏—á–Ω—ã–µ. –•–æ—Ä–æ—à–æ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Å –∑–∞—â–∏—Ç–æ–π.",
        "calm": "–¢–æ–ª–ø–∞ –≤–µ–¥—ë—Ç —Å–µ–±—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å–ø–æ–∫–æ–π–Ω–æ, –¥–≤–∏–∂–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–µ–µ, —É—Ä–æ–≤–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ª—É—á—à–µ.",
        "trend": "–¢–æ–ª–ø–∞ —Å–ª–µ–¥—É–µ—Ç —É—Å—Ç–æ–π—á–∏–≤–æ–º—É –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é. –ü–æ–≤–µ–¥–µ–Ω–∏–µ –±–æ–ª–µ–µ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–æ, —Ç—Ä–µ–Ω–¥—ã —á–∏—Ç–∞—é—Ç—Å—è —è—Å–Ω–µ–µ.",
    }

    return {
        "code": base,
        "label": labels[base],
        "description": descriptions[base],
    }


def get_deep_profile(tz_number: int, tz_name: str, moon_phase_code: str | None = None) -> dict:
    """
    –ì–ª—É–±–∏–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –¥–Ω—è: –∞—Ä—Ö–µ—Ç–∏–ø –ø–µ—á–∞—Ç–∏, —Ç–æ–Ω, —Å—Ü–µ–Ω–∞—Ä–∏–π —Ç–æ–ª–ø—ã, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.
    """
    sign_info = SIGN_PROFILES.get(tz_name, None)
    tone_info = TONE_PROFILES.get(tz_number, None)

    if sign_info is None:
        sign_info = {
            "ru": tz_name,
            "arch": "",
            "crowd": "",
            "trading": ""
        }
    if tone_info is None:
        tone_info = {
            "name": str(tz_number),
            "essence": "",
            "trading": ""
        }

    # –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–¥ (–∞—Ä—Ö–µ—Ç–∏–ø + —Ç–æ–Ω)
    combined_self_parts = []
    if sign_info.get("arch"):
        combined_self_parts.append(sign_info["arch"])
    if tone_info.get("essence"):
        combined_self_parts.append(tone_info["essence"])
    combined_self_text = " ".join(combined_self_parts).strip()

    # –¢–æ—Ä–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–ø–µ—á–∞—Ç—å + —Ç–æ–Ω)
    combined_trading_parts = []
    if sign_info.get("trading"):
        combined_trading_parts.append(sign_info["trading"])
    if tone_info.get("trading"):
        combined_trading_parts.append(tone_info["trading"])
    combined_trading_text = " ".join(combined_trading_parts).strip()

    # –°—Ü–µ–Ω–∞—Ä–∏–π —Ç–æ–ª–ø—ã: –ø–µ—á–∞—Ç—å + —Ç–æ–Ω + –õ—É–Ω–∞
    crowd_text = sign_info.get("crowd", "")

    stress_tones = {2, 9, 11}
    strong_tones = {4, 5, 6, 7}
    harmony_tones = {8, 12}

    tone_add = ""
    if tz_number in stress_tones:
        tone_add = " –¢–æ–Ω –¥–Ω—è —É—Å–∏–ª–∏–≤–∞–µ—Ç –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, –∫—Ä–∞–π–Ω–æ—Å—Ç–∏ –∏ —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç—å —Ç–æ–ª–ø—ã –∫ —Ä–µ–∑–∫–∏–º —Ä–µ—à–µ–Ω–∏—è–º."
    elif tz_number in strong_tones:
        tone_add = " –¢–æ–Ω –¥–Ω—è –¥–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, —Ç–æ–ª–ø–∞ –≤–µ–¥—ë—Ç —Å–µ–±—è –±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ."
    elif tz_number in harmony_tones:
        tone_add = " –¢–æ–Ω –¥–Ω—è —Å—Ç—Ä–µ–º–∏—Ç—Å—è –≤—ã—Ä–æ–≤–Ω—è—Ç—å –∏ –≥–∞—Ä–º–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–∫—Ü–∏–∏ —Ç–æ–ª–ø—ã."

    moon_add = ""
    if moon_phase_code == "full":
        moon_add = " –ü–æ–ª–Ω–æ–ª—É–Ω–∏–µ —Ä–∞–∑–¥—É–≤–∞–µ—Ç —ç–º–æ—Ü–∏–∏, —Ä–µ–∞–∫—Ü–∏–∏ —Ç–æ–ª–ø—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –±–æ–ª–µ–µ –∫—Ä–∞–π–Ω–∏–º–∏ –∏ –∏–º–ø—É–ª—å—Å–∏–≤–Ω—ã–º–∏."
    elif moon_phase_code == "waning":
        moon_add = " –ù–∞ —É–±—ã–≤–∞—é—â–µ–π –õ—É–Ω–µ —Ç–æ–ª–ø–∞ –±–æ–ª—å—à–µ —Å–∫–ª–æ–Ω–Ω–∞ –∫ –≤—ã–¥–æ—Ö—É, —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–µ, —á–µ–º –∫ –±–µ–∑—É–º–Ω—ã–º –∏–º–ø—É–ª—å—Å–∞–º."
    elif moon_phase_code == "waxing":
        moon_add = " –ù–∞ —Ä–∞—Å—Ç—É—â–µ–π –õ—É–Ω–µ —Ç–æ–ª–ø–∞ –±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω–∞ –∏ –ª–µ–≥—á–µ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∏–º–ø—É–ª—å—Å—ã –∏ –∏–¥–µ–∏."
    elif moon_phase_code == "new":
        moon_add = " –ù–∞ –Ω–æ–≤–æ–ª—É–Ω–∏–µ —Ç–æ–ª–ø–∞ –∫–∞–∫ –±—É–¥—Ç–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, —ç–Ω–µ—Ä–≥–∏—è –µ—â—ë –Ω–µ –¥–æ –∫–æ–Ω—Ü–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞."

    crowd_scenario = (crowd_text + tone_add + moon_add).strip()

    return {
        "sign_ru": sign_info["ru"],
        "sign_arch": sign_info["arch"],
        "sign_crowd": sign_info["crowd"],
        "tone_name": tone_info["name"],
        "tone_essence": tone_info["essence"],
        "tone_trading": tone_info["trading"],
        "combined_trading": combined_trading_text,
        "combined_self": combined_self_text,
        "crowd_scenario": crowd_scenario,
    }


# --- –ë–ò–û–†–ò–¢–ú–´ + –¢–†–ï–ù–ò–†–û–í–ö–ê + –¶–ò–†–ö–ê–î–ù–´–ô –†–ï–ñ–ò–ú + –ü–ò–¢–ê–ù–ò–ï --- #

def get_biorhythms(birth_date: date, target_date: date) -> dict:
    """
    4 –±–∏–æ—Ä–∏—Ç–º–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç -100 –¥–æ +100:
    —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π / —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π / –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π / –¥—É—Ö–æ–≤–Ω—ã–π.
    """
    days_alive = (target_date - birth_date).days

    def cycle(period: int) -> int:
        value = math.sin(2 * math.pi * days_alive / period)
        percent = round(value * 100)
        return percent

    return {
        "physical": cycle(23),
        "emotional": cycle(28),
        "intellectual": cycle(33),
        "spiritual": cycle(53),
    }


def get_training_recommendation(bior: dict, day_class: dict, moon_phase_code: str | None) -> dict:
    """
    –û–±–æ–±—â—ë–Ω–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ –Ω–∞ –¥–µ–Ω—å.
    """
    phys = bior["physical"]
    emo = bior["emotional"]
    day_level = day_class["level"]

    danger = day_level == "danger"

    # –ñ—ë—Å—Ç–∫–∏–µ —Å—Ç–æ–ø-—É—Å–ª–æ–≤–∏—è
    if danger or moon_phase_code == "full":
        return {
            "type": "–û—Ç–¥—ã—Ö / –º—è–≥–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",
            "text": "–î–µ–Ω—å —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –∏ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–º –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ–º. –õ—É—á—à–µ –ø—Ä–æ–≥—É–ª–∫–∞, –¥—ã—Ö–∞–Ω–∏–µ, –ª—ë–≥–∫–∞—è —Ä–∞—Å—Ç—è–∂–∫–∞. "
                    "–ò–∑–±–µ–≥–∞—Ç—å —Ç—è–∂—ë–ª—ã—Ö —Å–∏–ª–æ–≤—ã—Ö –∏ –∏–∑–º–∞—Ç—ã–≤–∞—é—â–µ–≥–æ –∫–∞—Ä–¥–∏–æ."
        }

    # –°–∏–ª—å–Ω—ã–π –¥–µ–Ω—å + –≤—ã—Å–æ–∫–∞—è —Ñ–∏–∑–∏–∫–∞
    if day_level == "strong" and phys > 50:
        return {
            "type": "–°–∏–ª–æ–≤–∞—è / –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞",
            "text": "–≠–Ω–µ—Ä–≥–∏—è –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –ø–∏–∫–µ. –•–æ—Ä–æ—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —Å–∏–ª–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã (–∫–æ—Ä–ø—É—Å, –Ω–æ–≥–∏), –∫—Ä—É–≥–æ–≤—ã—Ö –∏–ª–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ "
                    "—Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º —Ç–µ—Ö–Ω–∏–∫–∏ –∏ –±–µ–∑ —Ñ–∞–Ω–∞—Ç–∏–∑–º–∞."
        }

    # –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –¥–µ–Ω—å + —Å—Ä–µ–¥–Ω—è—è —Ñ–∏–∑–∏–∫–∞
    if phys > 20:
        return {
            "type": "–ö–∞—Ä–¥–∏–æ / –¥–∏–Ω–∞–º–∏–∫–∞",
            "text": "–•–æ—Ä–æ—à–∏–π –¥–µ–Ω—å –¥–ª—è –¥–∏–Ω–∞–º–∏–∫–∏: –±—ã—Å—Ç—Ä–∞—è —Ö–æ–¥—å–±–∞, –ª—ë–≥–∫–∏–π –±–µ–≥, –≤–µ–ª–æ—Å–∏–ø–µ–¥. –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å 1‚Äì2 —Å–∏–ª–æ–≤—ã—Ö –±–ª–æ–∫–∞ –±–µ–∑ –ø–µ—Ä–µ–≥—Ä—É–∑–∞."
        }

    # –ù–∏–∑–∫–∏–π —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Ä–∏—Ç–º
    if phys < -20:
        return {
            "type": "–†–∞—Å—Ç—è–∂–∫–∞ / –º–æ–±–∏–ª–∏—Ç–∏",
            "text": "–§–∏–∑–∏—á–µ—Å–∫–∏–π —Ä–∏—Ç–º –ø—Ä–æ—Å–∞–∂–µ–Ω. –û–ø—Ç–∏–º–∞–ª—å–Ω–æ: —Å—É—Å—Ç–∞–≤–Ω–∞—è –≥–∏–º–Ω–∞—Å—Ç–∏–∫–∞, –π–æ–≥–∞, –º—è–≥–∫–∞—è —Ä–∞—Å—Ç—è–∂–∫–∞. "
                    "–°—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ –¥–≤–∏–∂–µ–Ω–∏–π –∏ –¥—ã—Ö–∞–Ω–∏–∏."
        }

    # –≠–º–æ—Ü–∏–∏ –≤ –º–∏–Ω—É—Å–µ
    if emo < -30:
        return {
            "type": "–°–ø–æ–∫–æ–π–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞",
            "text": "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–æ–Ω –Ω–µ—Å—Ç–∞–±–∏–ª–µ–Ω. –ü–æ–¥–æ–π–¥—É—Ç –ø—Ä–æ–≥—É–ª–∫–∏, –ª—ë–≥–∫–æ–µ –∫–∞—Ä–¥–∏–æ, —Å–ø–æ–∫–æ–π–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –±–µ–∑ –≥–æ–Ω–∫–∏ –∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º."
        }

    # –ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π
    return {
        "type": "–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞",
        "text": "–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–µ–Ω—å: –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —É–º–µ—Ä–µ–Ω–Ω—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É (—á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ –ª—ë–≥–∫–∏—Ö —Å–∏–ª–æ–≤—ã—Ö –∏ –∫–∞—Ä–¥–∏–æ) "
                "–∏ —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ–ª–∏—Ç—å –æ—Å–∞–Ω–∫–µ, –¥—ã—Ö–∞–Ω–∏—é –∏ —Ç–µ—Ö–Ω–∏–∫–µ."
    }


def get_daily_schedule(birth_date: date,
                       target_date: date,
                       day_class: dict,
                       moon_phase_code: str | None,
                       bior: dict) -> list[dict]:
    """
    –¶–∏—Ä–∫–∞–¥–Ω—ã–π —Ä–µ–∂–∏–º –¥–Ω—è 4 Muluk —Å —É—á—ë—Ç–æ–º:
    - –ø–æ–¥—ä—ë–º ~06:00, —Å–æ–Ω ~22:30;
    - –∫–ª–∞—Å—Å–∞ –¥–Ω—è (strong / normal / background / danger);
    - –±–∏–æ—Ä–∏—Ç–º–æ–≤;
    - —Ñ–∞–∑—ã –õ—É–Ω—ã.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –±–ª–æ–∫–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏.
    """
    phys = bior["physical"]
    emo = bior["emotional"]
    intel = bior["intellectual"]
    level = day_class["level"]

    danger = level == "danger"
    full_moon = moon_phase_code == "full"

    blocks: list[dict] = []

    # 06:00‚Äì07:00 ‚Äî –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ
    if emo < -20 or full_moon:
        morning_note = (
            "–ú—è–≥–∫–æ–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ: –≤–æ–¥–∞, –¥—ã—Ö–∞–Ω–∏–µ, –ª—ë–≥–∫–∞—è —Å—É—Å—Ç–∞–≤–Ω–∞—è —Ä–∞–∑–º–∏–Ω–∫–∞. "
            "–ë–µ–∑ –ø—Ä—ã–∂–∫–æ–≤ –∏ —Å–∏–ª—å–Ω–æ–≥–æ –∫–∞—Ä–¥–∏–æ, –¥–∞—Ç—å –Ω–µ—Ä–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –ø—Ä–æ—Å–Ω—É—Ç—å—Å—è —Å–ø–æ–∫–æ–π–Ω–æ."
        )
    else:
        morning_note = (
            "–ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ: —Å—Ç–∞–∫–∞–Ω –≤–æ–¥—ã, –∫–æ—Ä–æ—Ç–∫–∞—è —Å—É—Å—Ç–∞–≤–Ω–∞—è –≥–∏–º–Ω–∞—Å—Ç–∏–∫–∞, 5‚Äì10 –º–∏–Ω—É—Ç –¥—ã—Ö–∞–Ω–∏—è. "
            "–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª—ë–≥–∫—É—é –¥–∏–Ω–∞–º–∏–∫—É (–ø–æ—Ö–æ–¥–∏—Ç—å, –Ω–µ–º–Ω–æ–≥–æ —Ä–∞—Å—Ç—è–Ω—É—Ç—å—Å—è)."
        )

    blocks.append({
        "time": "06:00‚Äì07:00",
        "label": "–ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ –¥–Ω—è",
        "training": "–õ—ë–≥–∫–∞—è –∑–∞—Ä—è–¥–∫–∞, –¥—ã—Ö–∞–Ω–∏–µ, —Å—É—Å—Ç–∞–≤–Ω–∞—è –≥–∏–º–Ω–∞—Å—Ç–∏–∫–∞.",
        "note": morning_note,
    })

    # 07:00‚Äì10:00 ‚Äî —è—Å–Ω–∞—è –≥–æ–ª–æ–≤–∞
    if intel > 30:
        note_710 = (
            "–£–º –≤ —Ö–æ—Ä–æ—à–µ–º —Ç–æ–Ω—É—Å–µ. –õ—É—á—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –∞–Ω–∞–ª–∏–∑–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤, –≤–µ–¥–µ–Ω–∏—è –¥–Ω–µ–≤–Ω–∏–∫–∞ —Ç—Ä–µ–π–¥–µ—Ä–∞, "
            "–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–Ω—è –∏ —Ä–∞–∑–±–æ—Ä–æ–≤ —Å–¥–µ–ª–æ–∫."
        )
    else:
        note_710 = (
            "–£–º –≤–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ. –ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ª—ë–≥–∫–∏–π —Ä–∞–∑–±–æ—Ä —Ä—ã–Ω–∫–∞, –Ω–æ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ–∑–∫–∏—Ö —Ä–µ—à–µ–Ω–∏–π. "
            "–•–æ—Ä–æ—à–µ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –∏ —Å–∏—Å—Ç–µ–º."
        )

    blocks.append({
        "time": "07:00‚Äì10:00",
        "label": "–ú–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Ñ–æ–∫—É—Å",
        "training": "–û–±—É—á–µ–Ω–∏–µ, –∞–Ω–∞–ª–∏–∑, –º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞. –§–∏–∑–∏—á–µ—Å–∫–∏ ‚Äî –º–∞–∫—Å–∏–º—É–º –ª—ë–≥–∫–∞—è —Ö–æ–¥—å–±–∞.",
        "note": note_710,
    })

    # 10:00‚Äì14:00 ‚Äî –≥–ª–∞–≤–Ω—ã–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –±–ª–æ–∫
    if danger or full_moon:
        train_1014 = "–ü—Ä–æ–≥—É–ª–∫–∞, –º—è–≥–∫–æ–µ –∫–∞—Ä–¥–∏–æ, –Ω–∏–∫–∞–∫–∏—Ö —Ç—è–∂—ë–ª—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ –∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π."
    elif level == "strong" and phys > 50:
        train_1014 = "–û—Å–Ω–æ–≤–Ω–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –±–ª–æ–∫: —Å–∏–ª–æ–≤–∞—è / –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ (–∫–æ—Ä–ø—É—Å, –Ω–æ–≥–∏), —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º —Ç–µ—Ö–Ω–∏–∫–∏."
    elif phys > 20:
        train_1014 = "–ö–∞—Ä–¥–∏–æ-—Å–µ—Å—Å–∏—è: –±—ã—Å—Ç—Ä–∞—è —Ö–æ–¥—å–±–∞, –ª—ë–≥–∫–∏–π –±–µ–≥, –≤–µ–ª–æ—Å–∏–ø–µ–¥, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—É —Å–∏–ª–æ–≤—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π."
    elif phys < -20:
        train_1014 = "–ú–æ–±–∏–ª–∏—Ç–∏, —Ä–∞—Å—Ç—è–∂–∫–∞, —Ä–∞–±–æ—Ç–∞ —Å –æ—Å–∞–Ω–∫–æ–π –∏ –¥—ã—Ö–∞–Ω–∏–µ–º. –¢–µ–ª–æ –±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç –∑–∞ –º—è–≥–∫–æ—Å—Ç—å."
    else:
        train_1014 = "–£–º–µ—Ä–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∏–ª–∏ –∞–∫—Ç–∏–≤–Ω–∞—è –ø—Ä–æ–≥—É–ª–∫–∞, –±–µ–∑ –≤—ã—Ö–æ–¥–∞ –Ω–∞ –º–∞–∫—Å–∏–º—É–º."

    note_1014 = (
        "–í —ç—Ç–æ –æ–∫–Ω–æ —É –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ª—é–¥–µ–π –º–∞–∫—Å–∏–º—É–º –¥–Ω–µ–≤–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏. "
        "–ï—Å–ª–∏ –µ—Å—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ ‚Äî –ª—É—á—à–µ —Å—Ç–∞–≤–∏—Ç—å –µ—ë —Å—é–¥–∞. "
        "–î–ª—è —Ç—Ä–µ–π–¥–∏–Ω–≥–∞ ‚Äî –±–æ–ª—å—à–µ –∞–Ω–∞–ª–∏–∑, —á–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–¥–µ–ª–∫–∏."
    )

    blocks.append({
        "time": "10:00‚Äì14:00",
        "label": "–ü–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",
        "training": train_1014,
        "note": note_1014,
    })

    # 14:00‚Äì18:00 ‚Äî —Ä–∞–±–æ—Ç–∞, —Ç—Ä–µ–π–¥–∏–Ω–≥, –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ
    if level in {"background", "danger"}:
        trade_1418 = "–ù–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ —Ä—ã–Ω–∫–æ–º, –≤–µ–¥–µ–Ω–∏–µ –¥–Ω–µ–≤–Ω–∏–∫–∞, –∞–Ω–∞–ª–∏–∑ —Å–¥–µ–ª–æ–∫. –ù–æ–≤—ã–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –≤—Ö–æ–¥—ã –ª—É—á—à–µ –∏–∑–±–µ–≥–∞—Ç—å."
    else:
        trade_1418 = "–ê–∫–∫—É—Ä–∞—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ —Å–∏—Å—Ç–µ–º–µ. –ï—Å–ª–∏ –±–æ—Ç –≤ —Ä–µ–∂–∏–º–µ SAFE/NORMAL ‚Äî –º–æ–∂–Ω–æ –ø–æ–∑–≤–æ–ª–∏—Ç—å –µ–º—É –¥–µ–ª–∞—Ç—å —Å–≤–æ—ë –¥–µ–ª–æ."

    blocks.append({
        "time": "14:00‚Äì18:00",
        "label": "–†–∞–±–æ—á–∏–π –±–ª–æ–∫ / —Ä—ã–Ω–æ–∫",
        "training": "–ü–æ –æ—â—É—â–µ–Ω–∏—è–º: –ø—Ä–æ–≥—É–ª–∫–∞, –ª—ë–≥–∫–æ–µ –∫–∞—Ä–¥–∏–æ –∏–ª–∏ –æ—Ç–¥—ã—Ö –ø–æ—Å–ª–µ –¥–Ω–µ–≤–Ω–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏.",
        "note": trade_1418,
    })

    # 18:00‚Äì20:00 ‚Äî –≤—ã–¥–æ—Ö
    if phys > 40 and not (danger or full_moon):
        eve_train = "–°–ø–æ–∫–æ–π–Ω–∞—è –ø—Ä–æ–≥—É–ª–∫–∞, –ª—ë–≥–∫–æ–µ –∫–∞—Ä–¥–∏–æ, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º—è–≥–∫—É—é —Ä–∞—Å—Ç—è–∂–∫—É."
    else:
        eve_train = "–¢–∏—Ö–∞—è –ø—Ä–æ–≥—É–ª–∫–∞, —Ä–∞—Å—Ç—è–∂–∫–∞, —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ. –ù–∏–∫–∞–∫–∏—Ö —Ç—è–∂—ë–ª—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫."

    blocks.append({
        "time": "18:00‚Äì20:00",
        "label": "–í—ã—Ö–æ–¥ –∏–∑ –¥–Ω—è",
        "training": eve_train,
        "note": "–í—Ä–µ–º—è –ø–µ—Ä–µ–≤–∞—Ä–∏—Ç—å –¥–µ–Ω—å, –Ω–µ –ª–µ–∑—Ç—å –≤ —Ç—è–∂—ë–ª—ã–µ —Ä–µ—à–µ–Ω–∏—è (–Ω–∏ –≤ –∂–∏–∑–Ω–∏, –Ω–∏ –Ω–∞ —Ä—ã–Ω–∫–µ).",
    })

    # 20:00‚Äì22:30 ‚Äî –∑–∞–∫—Ä—ã—Ç–∏–µ –¥–Ω—è
    if emo < -20:
        night_note = (
            "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–æ–Ω –ø—Ä–æ—Å–∞–∂–µ–Ω. –ú–∞–∫—Å–∏–º—É–º ‚Äî –º—è–≥–∫–∞—è —Ä–∞—Å—Ç—è–∂–∫–∞, –¥—ã—Ö–∞–Ω–∏–µ, —Ç—ë–ø–ª—ã–π –¥—É—à. "
            "–≠–∫—Ä–∞–Ω–æ–≤ –∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ª—É—á—à–µ –∏–∑–±–µ–≥–∞—Ç—å, –æ—Å–æ–±–µ–Ω–Ω–æ –ø–µ—Ä–µ–¥ —Å–Ω–æ–º."
        )
    else:
        night_note = (
            "–ü–ª–∞–≤–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –¥–Ω—è: —á—Ç–µ–Ω–∏–µ, —Ä–∞—Å—Ç—è–∂–∫–∞, –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏. "
            "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –Ω–µ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å –∏ –Ω–µ —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ —Å–Ω–æ–º."
        )

    blocks.append({
        "time": "20:00‚Äì22:30",
        "label": "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ —Å–Ω—É",
        "training": "–†–∞—Å—Ç—è–∂–∫–∞, –¥—ã—Ö–∞–Ω–∏–µ, —Ä–µ–ª–∞–∫—Å–∞—Ü–∏—è.",
        "note": night_note,
    })

    return blocks


def get_nutrition_profile(bior: dict,
                          day_class: dict,
                          moon_phase_code: str | None) -> dict:
    """
    –ü–∏—Ç–∞–Ω–∏–µ –¥–Ω—è –¥–ª—è 4 Muluk:
    - —Ä–µ–∂–∏–º: strict / base / gentle
    - —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
    - —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–∞–≤–∏–ª –Ω–∞ –¥–µ–Ω—å.
    """
    phys = bior["physical"]
    emo = bior["emotional"]
    level = day_class["level"]

    full_moon = moon_phase_code == "full"

    # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –±–∞–∑–æ–≤—ã–π —Ä–µ–∂–∏–º
    mode = "base"
    label = "–ë–∞–∑–æ–≤—ã–π –¥–µ–Ω—å –ø–∏—Ç–∞–Ω–∏—è"
    description = (
        "–°—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–µ–Ω—å: –¥–µ—Ä–∂–∏–º —É–º–µ—Ä–µ–Ω–Ω—ã–π –¥–µ—Ñ–∏—Ü–∏—Ç –∫–∞–ª–æ—Ä–∏–π, —Ä–æ–≤–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ –±–µ–∑ –∫—Ä–∞–π–Ω–æ—Å—Ç–µ–π. "
        "–§–æ–∫—É—Å ‚Äî –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ –µ–¥—ã –∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏."
    )
    rules: list[str] = [
        "3 –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏ + 1‚Äì2 –ª—ë–≥–∫–∏—Ö –ø–µ—Ä–µ–∫—É—Å–∞.",
        "–ü–æ—Å–ª–µ 19:30 ‚Äî —Ç–æ–ª—å–∫–æ –≤–æ–¥–∞ –∏–ª–∏ —Ç—Ä–∞–≤—è–Ω–æ–π —á–∞–π.",
        "–°–ª–∞–¥–∫–æ–µ –∏ –≤—ã–ø–µ—á–∫—É ‚Äî —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –¥–Ω—è –∏ –≤ –Ω–µ–±–æ–ª—å—à–æ–º –æ–±—ä—ë–º–µ (–µ—Å–ª–∏ –æ—á–µ–Ω—å —Ö–æ—á–µ—Ç—Å—è).",
    ]

    # –£—Å–∫–æ—Ä–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º (—Å—Ç—Ä–æ–∂–µ)
    if level == "strong" and phys >= 20 and emo > -20 and not full_moon:
        mode = "strict"
        label = "–£—Å–∫–æ—Ä–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º –ø–æ—Ö—É–¥–µ–Ω–∏—è"
        description = (
            "–î–µ–Ω—å —Å–∏–ª—ã –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —ç–Ω–µ—Ä–≥–∏–∏. –ú–æ–∂–Ω–æ –ø–æ–∑–≤–æ–ª–∏—Ç—å —Å–µ–±–µ –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–π –¥–µ—Ñ–∏—Ü–∏—Ç –∏ "
            "–±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–∏—Ç–∞–Ω–∏—è, –Ω–µ –ª–æ–º–∞—è —Å–∏—Å—Ç–µ–º—É."
        )
        rules = [
            "–ú–∞–∫—Å–∏–º—É–º 3 –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏, –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–∫—É—Å–æ–≤ (–µ—Å–ª–∏ –Ω–µ—Ç —Å–∏–ª—å–Ω–æ–≥–æ –≥–æ–ª–æ–¥–∞).",
            "–°–ª–∞–¥–∫–æ–µ, —Ö–ª–µ–±, –≤—ã–ø–µ—á–∫–∞ ‚Äî –∏—Å–∫–ª—é—á–∏—Ç—å –∏–ª–∏ —Å–≤–µ—Å—Ç–∏ –∫ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–æ–º—É –º–∏–Ω–∏–º—É–º—É –¥–æ –æ–±–µ–¥–∞.",
            "–ü–æ–ª–æ–≤–∏–Ω–∞ —Ç–∞—Ä–µ–ª–∫–∏ ‚Äî –æ–≤–æ—â–∏, —á–µ—Ç–≤–µ—Ä—Ç—å ‚Äî –±–µ–ª–æ–∫, —á–µ—Ç–≤–µ—Ä—Ç—å ‚Äî —Å–ª–æ–∂–Ω—ã–µ —É–≥–ª–µ–≤–æ–¥—ã.",
            "–ü–æ—Å–ª–µ 18:30 ‚Äî —Ç–æ–ª—å–∫–æ –ª—ë–≥–∫–∏–π —É–∂–∏–Ω: –±–µ–ª–æ–∫ + –æ–≤–æ—â–∏, –±–µ–∑ —Ç—è–∂—ë–ª—ã—Ö —É–≥–ª–µ–≤–æ–¥–æ–≤.",
        ]

    # –©–∞–¥—è—â–∏–π —Ä–µ–∂–∏–º (–º—è–≥—á–µ, —á—Ç–æ–±—ã –Ω–µ —Å–æ—Ä–≤–∞—Ç—å—Å—è)
    if level in {"background", "danger"} or emo <= -20 or full_moon:
        mode = "gentle"
        label = "–©–∞–¥—è—â–∏–π —Ä–µ–∂–∏–º ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç —Å—Ä—ã–≤–æ–≤"
        description = (
            "–≠–Ω–µ—Ä–≥–∏—è –∏–ª–∏ —ç–º–æ—Ü–∏–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã. –í–∞–∂–Ω–æ –Ω–µ —É—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∂—ë—Å—Ç–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, —á—Ç–æ–±—ã –Ω–µ —Å–æ—Ä–≤–∞—Ç—å—Å—è. "
            "–°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∏—Ç–∞–Ω–∏—è, –Ω–æ –±–µ–∑ –≥–æ–ª–æ–¥–æ–≤–æ–∫ –∏ —Å–∞–º–æ–Ω–∞–∫–∞–∑–∞–Ω–∏—è."
        )
        rules = [
            "–†–µ–≥—É–ª—è—Ä–Ω–æ –µ—Å—Ç—å 3 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å, –Ω–µ –¥–æ–ø—É—Å–∫–∞—è —Å–∏–ª—å–Ω–æ–≥–æ –≥–æ–ª–æ–¥–∞.",
            "–ï—Å–ª–∏ –æ—á–µ–Ω—å —Ç—è–Ω–µ—Ç –∫ —Å–ª–∞–¥–∫–æ–º—É ‚Äî —Å—ä–µ—Å—Ç—å –Ω–µ–º–Ω–æ–≥–æ –≤ –ø–µ—Ä–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –¥–Ω—è –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ, –±–µ–∑ —á—É–≤—Å—Ç–≤–∞ –≤–∏–Ω—ã.",
            "–£–∂–∏–Ω ‚Äî –ª—ë–≥–∫–∏–π, –Ω–æ –Ω–µ –≥–æ–ª–æ–¥–Ω—ã–π: –±–µ–ª–æ–∫ + –æ–≤–æ—â–∏, –±–µ–∑ –ø–µ—Ä–µ–µ–¥–∞–Ω–∏—è.",
            "–°–¥–µ–ª–∞—Ç—å –∞–∫—Ü–µ–Ω—Ç –Ω–∞ –≤–æ–¥–µ, —Ç—ë–ø–ª—ã—Ö –Ω–∞–ø–∏—Ç–∫–∞—Ö –∏ —Å–ø–æ–∫–æ–π–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –¥–Ω—è.",
        ]

    return {
        "mode": mode,              # strict / base / gentle
        "label": label,
        "description": description,
        "rules": rules,
    }


# --- –®–£–ú–ï–†–°–ö–ò–ô –ö–†–£–ì 360 (12 –º–µ—Å—è—Ü–µ–≤ √ó 30 –¥–Ω–µ–π) --- #

SUMERIAN_MONTHS = [
    {
        "name": "–ù–∏—Å–∞–Ω–Ω—É",
        "alt": "–ú–µ—Å—è—Ü –ø–æ—Å–µ–≤–∞",
        "archetype": "–ù–∞—á–∞–ª–æ —Ü–∏–∫–ª–∞, –ø–æ—Å–µ–≤, –∑–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –≠–Ω–µ—Ä–≥–∏—è –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è –∏ –ø–µ—Ä–≤—ã—Ö —à–∞–≥–æ–≤.",
        "base_energy": 70,
    },
    {
        "name": "–ê–π–∞—Ä—É",
        "alt": "–ú–µ—Å—è—Ü —Ä–æ—Å—Ç–∞",
        "archetype": "–†–æ—Å—Ç, —É–∫–æ—Ä–µ–Ω–µ–Ω–∏–µ, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –Ω–∞—Ä–∞—â–∏–≤–∞–Ω–∏–µ —Å–∏–ª.",
        "base_energy": 75,
    },
    {
        "name": "–°–∏–º–∞–Ω—É",
        "alt": "–ú–µ—Å—è—Ü —É–∫—Ä–µ–ø–ª–µ–Ω–∏—è",
        "archetype": "–£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä, —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è, –≤—ã—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –æ–ø–æ—Ä—ã.",
        "base_energy": 80,
    },
    {
        "name": "–î—É—É–∑—É",
        "alt": "–ú–µ—Å—è—Ü –∂–∞—Ä—ã",
        "archetype": "–ñ–∞—Ä, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, –ø–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, —Ä–∏—Å–∫ –ø–µ—Ä–µ–≥—Ä–µ–≤–∞.",
        "base_energy": 90,
    },
    {
        "name": "–ê–±—É",
        "alt": "–ú–µ—Å—è—Ü –∏—Å–ø—ã—Ç–∞–Ω–∏–π",
        "archetype": "–ò—Å–ø—ã—Ç–∞–Ω–∏—è, –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã, –≤—ã–±–æ—Ä, –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ—á–Ω–æ—Å—Ç—å.",
        "base_energy": 85,
    },
    {
        "name": "–£–ª—É–ª—É",
        "alt": "–ú–µ—Å—è—Ü —Å–±–æ—Ä–∞",
        "archetype": "–°–±–æ—Ä —É—Ä–æ–∂–∞—è, —Ñ–∏–∫—Å–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –ø–æ–¥–≤–µ–¥–µ–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö –∏—Ç–æ–≥–æ–≤.",
        "base_energy": 75,
    },
    {
        "name": "–¢–∞—à—Ä–∏—Ç—É",
        "alt": "–ú–µ—Å—è—Ü –∏—Ç–æ–≥–æ–≤",
        "archetype": "–ê–Ω–∞–ª–∏–∑, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤.",
        "base_energy": 65,
    },
    {
        "name": "–ê—Ä–∞—Ö—Å–∞–º–Ω–∞",
        "alt": "–ú–µ—Å—è—Ü —Å—Ç—Ä—É–∫—Ç—É—Ä—ã",
        "archetype": "–£–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏–µ, –ø—Ä–∞–≤–∏–ª–∞, –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏, –∑–∞–∫–æ–Ω—ã.",
        "base_energy": 60,
    },
    {
        "name": "–ö–∏—Å–ª–∏–≤—É",
        "alt": "–ú–µ—Å—è—Ü —Ç—å–º—ã",
        "archetype": "–¢—ë–º–Ω—ã–π –ø–µ—Ä–∏–æ–¥, –∏–Ω—Ç—Ä–æ—Å–ø–µ–∫—Ü–∏—è, —É—Ö–æ–¥ –≤–Ω—É—Ç—Ä—å, —ç–∫–æ–Ω–æ–º–∏—è —Å–∏–ª.",
        "base_energy": 45,
    },
    {
        "name": "–¢–µ–±–µ—Ç—É",
        "alt": "–ú–µ—Å—è—Ü –≥–ª—É–±–∏–Ω—ã",
        "archetype": "–ì–ª—É–±–æ–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ, –ø–µ—Ä–µ–æ—Å–º—ã—Å–ª–µ–Ω–∏–µ.",
        "base_energy": 40,
    },
    {
        "name": "–®–∞–±–∞—Ç—É",
        "alt": "–ú–µ—Å—è—Ü –ª–æ–º–∫–∏",
        "archetype": "–õ–æ–º–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–æ—Ä–º, –∫—Ä–∏–∑–∏—Å—ã, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é.",
        "base_energy": 50,
    },
    {
        "name": "–ê–¥–¥–∞—Ä—É",
        "alt": "–ú–µ—Å—è—Ü –ø–µ—Ä–µ—Ö–æ–¥–∞",
        "archetype": "–ü–µ—Ä–µ—Ö–æ–¥, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ü–∏–∫–ª–∞, –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –Ω–æ–≤–æ–º—É –≥–æ–¥—É.",
        "base_energy": 55,
    },
]

SUMERIAN_DECANS = [
    {
        "name": "–ü–µ—Ä–≤–∞—è –¥–µ–∫–∞–¥–∞",
        "archetype": "–ó–∞–ø—É—Å–∫ —Ñ–∞–∑—ã, –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.",
        "energy_shift": -5,
    },
    {
        "name": "–í—Ç–æ—Ä–∞—è –¥–µ–∫–∞–¥–∞",
        "archetype": "–ü–∏–∫ —Ñ–∞–∑—ã, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤ –º–µ—Å—è—Ü–∞.",
        "energy_shift": 5,
    },
    {
        "name": "–¢—Ä–µ—Ç—å—è –¥–µ–∫–∞–¥–∞",
        "archetype": "–ü–µ—Ä–µ—Ö–æ–¥, —Å–º–µ–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –º–µ—Å—è—Ü—É.",
        "energy_shift": 0,
    },
]


def get_sumerian_profile(d: date) -> dict:
    """
    –®—É–º–µ—Ä—Å–∫–∏–π –∫—Ä—É–≥ 360:
    - 360 –¥–Ω–µ–π —Ü–∏–∫–ª–∞
    - 12 "–º–µ—Å—è—Ü–µ–≤" √ó 30 –¥–Ω–µ–π
    - –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ 3 –¥–µ–∫–∞–¥—ã √ó 10 –¥–Ω–µ–π.
    –í—Å–µ —Ä–∞—Å—á—ë—Ç—ã –¥–µ–ª–∞–µ–º –ø–æ–≤–µ—Ä—Ö JDN, –Ω–µ —Ç—Ä–æ–≥–∞—è –ú–∞–π—è.
    """
    jdn = gregorian_to_jdn(d.year, d.month, d.day)
    idx = jdn % 360  # 0..359

    month_index = idx // 30          # 0..11
    day_in_month = idx % 30          # 0..29
    decan_index = day_in_month // 10 # 0..2

    month = SUMERIAN_MONTHS[month_index]
    decan = SUMERIAN_DECANS[decan_index]

    base_energy = month["base_energy"]
    energy_score = base_energy + decan["energy_shift"]
    energy_score = max(0, min(100, energy_score))

    if energy_score >= 80:
        energy_label = "–í—ã—Å–æ–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è"
    elif energy_score >= 60:
        energy_label = "–ü–æ–≤—ã—à–µ–Ω–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è"
    elif energy_score >= 40:
        energy_label = "–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å"
    else:
        energy_label = "–ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å"

    # –¢–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
    description = (
        f"{month['alt']} ‚Äî {month['archetype']} "
        f"–°–µ–π—á–∞—Å {decan['name'].lower()}: {decan['archetype']} "
        f"–≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏ –¥–µ–Ω—å –æ—â—É—â–∞–µ—Ç—Å—è –∫–∞–∫ —á–∞—Å—Ç—å —Ü–∏–∫–ª–∞ –≥–æ–¥–∞, –≥–¥–µ –≤–∞–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –æ–±—â–∏–π —Ñ–æ–Ω, "
        f"–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –º–æ–º–µ–Ω—Ç–Ω—ã–µ –∏–º–ø—É–ª—å—Å—ã."
    )

    # –°–æ–≤–µ—Ç—ã –ø–æ–¥ —Ç–≤–æ–π —Å—Ç–∏–ª—å (–∂–∏–∑–Ω—å + —Ç—Ä–µ–π–¥–∏–Ω–≥ + —Ç–µ–ª–æ)
    if energy_score >= 80:
        advice_trading = (
            "–°–∏–ª—å–Ω—ã–π —Ñ–æ–Ω –≥–æ–¥–∞: –ª–µ–≥–∫–æ –≤—Ö–æ–¥–∏—Ç—å –≤ –ø–µ—Ä–µ–≥—Ä–µ–≤. –ï—Å–ª–∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–ª–æ–∏ —Ç–æ–∂–µ –∑–µ–ª—ë–Ω—ã–µ ‚Äî –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–µ–µ, "
            "–Ω–æ —Å –∂—ë—Å—Ç–∫–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º —Ä–∏—Å–∫–∞."
        )
        advice_body = (
            "–¢–µ–ª–æ —Ö–æ—Ä–æ—à–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –Ω–∞–≥—Ä—É–∑–∫—É, –Ω–æ –≤–∞–∂–Ω–æ –Ω–µ —Å–∂–µ—á—å —Å–µ–±—è: –¥–æ–±–∞–≤—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —Å–æ–Ω, "
            "—á—Ç–æ–±—ã –Ω–µ —É–π—Ç–∏ –≤ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–≥—Ä–µ–≤."
        )
    elif energy_score >= 60:
        advice_trading = (
            "–ü–æ–≤—ã—à–µ–Ω–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –∫—Ä—É–≥–∞ 360: —Ö–æ—Ä–æ—à–∏–π —Ñ–æ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø–æ —Å–∏—Å—Ç–µ–º–µ –±–µ–∑ –∏–∑–ª–∏—à–Ω–µ–≥–æ —Ä–∏—Å–∫–∞. "
            "–ú–æ–∂–Ω–æ —É—Å–∏–ª–∏–≤–∞—Ç—å —Ç–∞–º, –≥–¥–µ –ú–∞–π—è –∏ –õ—É–Ω–∞ —Ç–æ–∂–µ –¥–∞—é—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ."
        )
        advice_body = (
            "–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —É–º–µ—Ä–µ–Ω–Ω—ã—Ö –∏ –¥–∞–∂–µ —á—É—Ç—å —É—Å–∏–ª–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫. –í–∞–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å –±–∞–ª–∞–Ω—Å –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è."
        )
    elif energy_score >= 40:
        advice_trading = (
            "–°—Ä–µ–¥–Ω–∏–π —Ñ–æ–Ω: –ª—É—á—à–µ –Ω–µ —Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞—Ç—å, –∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∞–∫–∫—É—Ä–∞—Ç–Ω–æ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–Ω—å –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞."
        )
        advice_body = (
            "–û–ø—Ç–∏–º–∞–ª—å–Ω–æ ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –ø—Ä–æ–≥—É–ª–∫–∏, —Ä–∞–±–æ—Ç–∞ —Å –æ—Å–∞–Ω–∫–æ–π –∏ –¥—ã—Ö–∞–Ω–∏–µ–º, –±–µ–∑ –∫—Ä–∞–π–Ω–æ—Å—Ç–µ–π."
        )
    else:
        advice_trading = (
            "–ù–∏–∑–∫–∏–π —Ñ–æ–Ω –≥–æ–¥–∞: –ª—É—á—à–µ –º–µ–Ω—å—à–µ –ª–µ–∑—Ç—å –≤ —Ä—ã–Ω–æ–∫, –±–æ–ª—å—à–µ –Ω–∞–±–ª—é–¥–∞—Ç—å –∏ —É–∫—Ä–µ–ø–ª—è—Ç—å —Å–∏—Å—Ç–µ–º—É "
            "–≤–º–µ—Å—Ç–æ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏."
        )
        advice_body = (
            "–¢–µ–ª–æ –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ —â–∞–¥—è—â–µ–º —Ä–µ–∂–∏–º–µ: –º—è–≥–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ, —Å–æ–Ω, —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Å—Ç—Ä–µ—Å—Å–∞ –∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∞."
        )

    return {
        "index": idx,
        "month_index": month_index,
        "month_name": month["name"],
        "month_alt": month["alt"],
        "month_archetype": month["archetype"],
        "decan_index": decan_index,
        "decan_name": decan["name"],
        "decan_archetype": decan["archetype"],
        "energy_score": energy_score,
        "energy_label": energy_label,
        "description": description,
        "advice_trading": advice_trading,
        "advice_body": advice_body,
    }


def get_bot_mode(signal_label: str, crowd_state_code: str) -> dict:
    """
    –ñ—ë—Å—Ç–∫–∞—è –º–∞—Ç—Ä–∏—Ü–∞:
    signal √ó crowd_state ‚Üí —Ä–µ–∂–∏–º –±–æ—Ç–∞ (OFF / SAFE / NORMAL / AGGRESSIVE).
    """
    signal = signal_label.strip().upper()

    if signal == "–°–¢–û–ü":
        mode_code = "OFF"
    elif signal.startswith("–û–°–¢–û–†–û–ñ–ù–û"):
        if crowd_state_code == "panic":
            mode_code = "OFF"
        elif crowd_state_code in {"volatile", "calm"}:
            mode_code = "SAFE"
        else:  # trend
            mode_code = "NORMAL"
    elif signal.startswith("–†–ê–ó–†–ï–®–ï–ù–û (–ê–ö–ö–£–†–ê–¢–ù–û"):
        if crowd_state_code in {"panic", "volatile"}:
            mode_code = "SAFE"
        else:  # calm, trend
            mode_code = "NORMAL"
    elif signal.startswith("–†–ê–ó–†–ï–®–ï–ù–û"):
        if crowd_state_code == "panic":
            mode_code = "SAFE"
        elif crowd_state_code in {"volatile", "calm"}:
            mode_code = "NORMAL"
        else:  # trend
            mode_code = "AGGRESSIVE"
    else:
        mode_code = "SAFE"

    labels = {
        "OFF": "OFF ‚Äî –Ω–µ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å",
        "SAFE": "SAFE ‚Äî –∑–∞—â–∏—Ç–Ω—ã–π —Ä–µ–∂–∏–º",
        "NORMAL": "NORMAL ‚Äî –±–∞–∑–æ–≤—ã–π —Ä–µ–∂–∏–º",
        "AGGRESSIVE": "AGGRESSIVE ‚Äî —É—Å–∏–ª–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º",
    }

    descriptions = {
        "OFF": (
            "–ë–æ—Ç –Ω–µ —Ç–æ—Ä–≥—É–µ—Ç. –î–µ–Ω—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –∞–Ω–∞–ª–∏–∑–∞ –∏ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö. "
            "–ó–∞—â–∏—Ç–∞ –∫–∞–ø–∏—Ç–∞–ª–∞ –∏–º–µ–µ—Ç –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç."
        ),
        "SAFE": (
            "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞—â–∏—Ç–Ω—ã–π —Ä–µ–∂–∏–º: —Å–∏–ª—å–Ω–æ —É—Ä–µ–∑–∞–Ω–Ω—ã–π —Ä–∏—Å–∫, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫, "
            "–∑–∞–ø—Ä–µ—Ç –æ–ø–∞—Å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π (–∫–æ–Ω—Ç—Ä—Ç—Ä–µ–Ω–¥, –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–µ –≤—Ö–æ–¥—ã)."
        ),
        "NORMAL": (
            "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–∞–±–æ—á–∏–π —Ä–µ–∂–∏–º: –±–æ—Ç —Ç–æ—Ä–≥—É–µ—Ç –ø–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ, —Å–æ–±–ª—é–¥–∞—è –æ–±—ã—á–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è "
            "—Ä–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π."
        ),
        "AGGRESSIVE": (
            "–£—Å–∏–ª–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º: –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ–±—ä—ë–º–æ–≤ –∏ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ—Å—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ "
            "—Å–∏–ª—å–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –¥–Ω—è –∏ —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ —Ç—Ä–µ–Ω–¥–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–æ–ª–ø—ã. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ."
        ),
    }

    return {
        "code": mode_code,
        "label": labels[mode_code],
        "description": descriptions[mode_code],
    }
# --- –í–û–°–¢–û–ß–ù–´–ô (–ö–ò–¢–ê–ô–°–ö–ò–ô) –ö–ê–õ–ï–ù–î–ê–†–¨ --- #

HEAVENLY_STEMS = [
    "–¶–∑—è",   # Jia  (Wood, Yang)
    "–ò",     # Yi   (Wood, Yin)
    "–ë–∏–Ω",   # Bing (Fire, Yang)
    "–î–∏–Ω",   # Ding (Fire, Yin)
    "–£",     # Wu   (Earth, Yang)
    "–¶–∑–∏",   # Ji   (Earth, Yin)
    "–ì—ç–Ω",   # Geng (Metal, Yang)
    "–°–∏–Ω—å",  # Xin  (Metal, Yin)
    "–ñ—ç–Ω—å",  # Ren  (Water, Yang)
    "–ì—É–π",   # Gui  (Water, Yin)
]

EARTHLY_BRANCHES = [
    "–¶–∑—ã",   # Rat
    "–ß–æ—É",   # Ox
    "–ò–Ω—å",   # Tiger
    "–ú–∞–æ",   # Rabbit
    "–ß—ç–Ω—å",  # Dragon
    "–°—ã",    # Snake
    "–£",     # Horse
    "–í—ç–π",   # Goat
    "–®—ç–Ω—å",  # Monkey
    "–Æ",     # Rooster
    "–°—é–π",   # Dog
    "–•–∞–π",   # Pig
]

EAST_ANIMALS_RU = [
    "–ö—Ä—ã—Å–∞",
    "–ë—ã–∫",
    "–¢–∏–≥—Ä",
    "–ö—Ä–æ–ª–∏–∫",
    "–î—Ä–∞–∫–æ–Ω",
    "–ó–º–µ—è",
    "–õ–æ—à–∞–¥—å",
    "–ö–æ–∑–∞",
    "–û–±–µ–∑—å—è–Ω–∞",
    "–ü–µ—Ç—É—Ö",
    "–°–æ–±–∞–∫–∞",
    "–°–≤–∏–Ω—å—è",
]

# –∏–Ω–¥–µ–∫—Å —Å—Ç–≤–æ–ª–∞ (0..9) -> (—ç–ª–µ–º–µ–Ω—Ç, –ò–Ω—å/–Ø–Ω)
EAST_ELEMENT_YIN_YANG = {
    0: ("–î–µ—Ä–µ–≤–æ", "–Ø–Ω"),
    1: ("–î–µ—Ä–µ–≤–æ", "–ò–Ω—å"),
    2: ("–û–≥–æ–Ω—å", "–Ø–Ω"),
    3: ("–û–≥–æ–Ω—å", "–ò–Ω—å"),
    4: ("–ó–µ–º–ª—è", "–Ø–Ω"),
    5: ("–ó–µ–º–ª—è", "–ò–Ω—å"),
    6: ("–ú–µ—Ç–∞–ª–ª", "–Ø–Ω"),
    7: ("–ú–µ—Ç–∞–ª–ª", "–ò–Ω—å"),
    8: ("–í–æ–¥–∞", "–Ø–Ω"),
    9: ("–í–æ–¥–∞", "–ò–Ω—å"),
}

EAST_ELEMENT_ARCHETYPE = {
    "–î–µ—Ä–µ–≤–æ": "–†–æ—Å—Ç, —Ä–∞–∑–≤–∏—Ç–∏–µ, —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ, –¥–≤–∏–∂–µ–Ω–∏–µ –≤–ø–µ—Ä—ë–¥. –ú–Ω–æ–≥–æ –∏–¥–µ–π –∏ –∂–µ–ª–∞–Ω–∏—è —Ä–∞—Å—Ç–∏.",
    "–û–≥–æ–Ω—å": "–°—Ç—Ä–∞—Å—Ç—å, –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ, —Ö–∞—Ä–∏–∑–º–∞. –≠–Ω–µ—Ä–≥–∏—è –¥–µ–π—Å—Ç–≤–∏—è –∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏.",
    "–ó–µ–º–ª—è": "–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å, –ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å. –û–ø–æ—Ä–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ.",
    "–ú–µ—Ç–∞–ª–ª": "–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞, –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ—Å—Ç—å, —Ç–æ—á–Ω–æ—Å—Ç—å. –ß—ë—Ç–∫–∏–µ —Ä–∞–º–∫–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞.",
    "–í–æ–¥–∞": "–ì–∏–±–∫–æ—Å—Ç—å, –≥–ª—É–±–∏–Ω–∞, –∏–Ω—Ç—É–∏—Ü–∏—è. –°–≤—è–∑—å —Å –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ–º –∏ —ç–º–æ—Ü–∏—è–º–∏.",
}

EAST_TRADING_ARCHETYPE = {
    "–î–µ—Ä–µ–≤–æ": "–•–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∏–¥–µ–π –∏ –º–µ—Ç–æ–¥–æ–≤. –†–∏—Å–∫ ‚Äî —Ä–∞—Å–ø—ã–ª–µ–Ω–∏–µ.",
    "–û–≥–æ–Ω—å": "–î–Ω–∏ –∏–º–ø—É–ª—å—Å–∞: –ª–µ–≥–∫–æ –≤—Ö–æ–¥–∏—Ç—å –≤ —Å–¥–µ–ª–∫–∏, –Ω–æ –≤–∞–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å —Ä–∏—Å–∫, —á—Ç–æ–±—ã –Ω–µ —Å–≥–æ—Ä–µ—Ç—å –≤ —ç–º–æ—Ü–∏—è—Ö.",
    "–ó–µ–º–ª—è": "–°–∏–ª—å–Ω—ã –¥–Ω–∏ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏: —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º, —Ä–∞–±–æ—Ç–∞ —Å —É—Ä–æ–≤–Ω—è–º–∏, –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è.",
    "–ú–µ—Ç–∞–ª–ª": "–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç—Ä–æ–≥–æ–≥–æ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–¥–µ–ª–æ–∫, —Ä–∞–±–æ—Ç—ã —Å —á—ë—Ç–∫–∏–º–∏ —Å–∏–≥–Ω–∞–ª–∞–º–∏.",
    "–í–æ–¥–∞": "–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è, –º—è–≥–∫–∏–µ –≤—Ö–æ–¥—ã, —á—Ç–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è —Ç–æ–ª–ø—ã. –û–ø–∞—Å–Ω–æ—Å—Ç—å ‚Äî –∏–∑–ª–∏—à–Ω—è—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.",
}

EAST_LIFE_ARCHETYPE = {
    "–î–µ—Ä–µ–≤–æ": "–î–µ–Ω—å –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –æ–±—â–µ–Ω–∏—è, —Ä–æ—Å—Ç–∞, –Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π.",
    "–û–≥–æ–Ω—å": "–î–µ–Ω—å –ø—Ä–æ—è–≤–ª–µ–Ω–Ω–æ—Å—Ç–∏: –≤—Å—Ç—Ä–µ—á–∏, –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏, –∞–∫—Ç–∏–≤–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ, —è—Ä–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è.",
    "–ó–µ–º–ª—è": "–î–µ–Ω—å –¥–ª—è –Ω–∞–≤–µ–¥–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞, –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–ª, —É–∫—Ä–µ–ø–ª–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –∂–∏–∑–Ω–∏.",
    "–ú–µ—Ç–∞–ª–ª": "–î–µ–Ω—å –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã: —Ä–µ–∂–∏–º, –ø–æ—Ä—è–¥–æ–∫, –æ—Ç–∫–∞–∑ –æ—Ç –ª–∏—à–Ω–µ–≥–æ, —Ä–∞–±–æ—Ç–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏.",
    "–í–æ–¥–∞": "–î–µ–Ω—å –¥–ª—è –≥–ª—É–±–æ–∫–∏—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ä–∞–±–æ—Ç—ã, –∞–Ω–∞–ª–∏–∑–∞ –∏ –º—è–≥–∫–æ–≥–æ –ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏—è.",
}


def get_eastern_profile(d: date) -> dict:
    """
    –í–æ—Å—Ç–æ—á–Ω—ã–π (–∫–∏—Ç–∞–π—Å–∫–∏–π) –ø—Ä–æ—Ñ–∏–ª—å –¥–Ω—è:
    - –∂–∏–≤–æ—Ç–Ω–æ–µ –≥–æ–¥–∞
    - —ç–ª–µ–º–µ–Ω—Ç
    - –ò–Ω—å/–Ø–Ω
    - –Ω–µ–±–µ—Å–Ω—ã–π —Å—Ç–≤–æ–ª + –∑–µ–º–Ω–∞—è –≤–µ—Ç–≤—å (–≥–æ–¥–æ–≤–æ–π —Å—Ç–æ–ª–ø)
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±–æ–±—â—ë–Ω–Ω—ã–π –∞—Ä—Ö–µ—Ç–∏–ø + —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.
    """

    year = d.year

    # –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è —Å—Ö–µ–º–∞: –±–µ—Ä—ë–º –≥–æ–¥ –∫–∞–∫ —Ü–µ–ª—ã–π (–±–µ–∑ —É—á—ë—Ç–∞ —Å–º–µ–Ω—ã –≥–æ–¥–∞ –ø–æ –∫–∏—Ç–∞–π—Å–∫–æ–º—É –∫–∞–ª–µ–Ω–¥–∞—Ä—é).
    # –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –¥–∞—Ç (–ø–æ—Å–ª–µ —Ñ–µ–≤—Ä–∞–ª—è) —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ö–æ—Ä–æ—à–æ –¥–ª—è –Ω–∞—à–µ–π –∑–∞–¥–∞—á–∏.
    cycle_index = (year - 4) % 60        # 1984 -> 0 (–¶–∑—è-–¶–∑—ã)
    stem_index = cycle_index % 10        # 0..9
    branch_index = cycle_index % 12      # 0..11

    stem_name = HEAVENLY_STEMS[stem_index]
    branch_name = EARTHLY_BRANCHES[branch_index]
    animal = EAST_ANIMALS_RU[branch_index]

    element, yin_yang = EAST_ELEMENT_YIN_YANG[stem_index]
    element_arch = EAST_ELEMENT_ARCHETYPE.get(element, "")
    trading_arch = EAST_TRADING_ARCHETYPE.get(element, "")
    life_arch = EAST_LIFE_ARCHETYPE.get(element, "")

    pillar_name = f"{stem_name}-{branch_name} ({element} {animal}, {yin_yang})"

    description = (
        f"–ì–æ–¥–æ–≤–æ–π —Å—Ç–æ–ª–ø {pillar_name}. –≠–Ω–µ—Ä–≥–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ {element.lower()} –æ–∫—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–Ω—è. "
        f"{element_arch}"
    )

    trading_advice = (
        f"–° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –≤–æ—Å—Ç–æ—á–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ ({element}) –¥–µ–Ω—å –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è —Ç–∞–∫: {trading_arch}"
    )
    life_advice = (
        f"–î–ª—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏ —ç–Ω–µ—Ä–≥–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ {element.lower()} –¥–∞—ë—Ç –∞–∫—Ü–µ–Ω—Ç: {life_arch}"
    )

    return {
        "year": year,
        "stem_index": stem_index,
        "branch_index": branch_index,
        "stem_name": stem_name,
        "branch_name": branch_name,
        "animal": animal,
        "element": element,
        "yin_yang": yin_yang,
        "pillar_name": pillar_name,
        "description": description,
        "trading_advice": trading_advice,
        "life_advice": life_advice,
    }
